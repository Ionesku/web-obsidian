# –û—Ç—á–µ—Ç –æ–± –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è—Ö

**–î–∞—Ç–∞:** 26 –æ–∫—Ç—è–±—Ä—è 2025  
**–ü—Ä–æ–µ–∫—Ç:** Obsidian Web  
**–§–∞–∑–∞:** –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

---

## üéØ –û–ë–ó–û–†

–û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã —Å–µ—Ä—å–µ–∑–Ω—ã–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã, –∫–æ—Ç–æ—Ä—ã–µ –¥–µ–ª–∞–ª–∏ —Å–∏—Å—Ç–µ–º—É –ø–æ–∏—Å–∫–∞ –Ω–µ–Ω–∞–¥–µ–∂–Ω–æ–π –∏ –Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–π.

---

## üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´ (–ò–°–ü–†–ê–í–õ–ï–ù–´)

### 1. ‚ùå‚Üí‚úÖ –ù–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –ø—É—Ç–µ–π API

**–ü—Ä–æ–±–ª–µ–º–∞:**
```
Backend —Ä–æ—É—Ç–µ—Ä: APIRouter(prefix="/search")
Main.py –º–æ–Ω—Ç–∏—Ä—É–µ—Ç: app.include_router(search_router, prefix="/api")
–ò–¢–û–ì–û: /api/search/search ‚ùå

Frontend –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç: /api/search ‚ùå
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** Frontend –Ω–µ –º–æ–≥ –æ–±—â–∞—Ç—å—Å—è —Å backend - –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã –≤–æ–∑–≤—Ä–∞—â–∞–ª–∏ 404!

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
```python
# backend/app/search/api.py
router = APIRouter(prefix="", tags=["search"])  # –£–±—Ä–∞–ª–∏ –ª–∏—à–Ω–∏–π prefix

# backend/app/main.py
app.include_router(search_router, prefix="/api/search")  # –Ø–≤–Ω–æ —É–∫–∞–∑–∞–ª–∏ –ø–æ–ª–Ω—ã–π –ø—É—Ç—å
```

**–¢–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- ‚úÖ `POST /api/search` - –æ—Å–Ω–æ–≤–Ω–æ–π –ø–æ–∏—Å–∫
- ‚úÖ `POST /api/search/index` - –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è
- ‚úÖ `GET /api/search/stats` - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- ‚úÖ `POST /api/search/optimize` - –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

---

### 2. ‚ùå‚Üí‚úÖ Race Conditions –≤ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏

**–ü—Ä–æ–±–ª–µ–º–∞:**
```typescript
// markdown-editor.tsx
await onSaveRef.current(content);        // 1. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
await searchEngine.indexLocal({...});    // 2. –õ–æ–∫–∞–ª—å–Ω–∞—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è

// –ï—Å–ª–∏ —à–∞–≥ 1 –ø—Ä–æ–≤–∞–ª–∏–ª—Å—è - –∏–Ω–¥–µ–∫—Å —É–∂–µ –æ–±–Ω–æ–≤–ª–µ–Ω! ‚ùå
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –†–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –º–µ–∂–¥—É —Ñ–∞–π–ª–∞–º–∏ –∏ –∏–Ω–¥–µ–∫—Å–æ–º.

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
- ‚úÖ –õ–æ–∫–∞–ª—å–Ω–∞—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è –≤—Å–µ–≥–¥–∞ –ø–µ—Ä–≤–∞—è (–º–≥–Ω–æ–≤–µ–Ω–Ω—ã–π –æ—Ç–∫–ª–∏–∫)
- ‚úÖ –°–µ—Ä–≤–µ—Ä–Ω–∞—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è —á–µ—Ä–µ–∑ –æ—á–µ—Ä–µ–¥—å —Å –ø–æ–≤—Ç–æ—Ä–∞–º–∏
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø—Ä–∏ reconnect

**–ù–æ–≤—ã–π flow:**
```typescript
1. –§–∞–π–ª —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä (—á–µ—Ä–µ–∑ API)
2. Backend –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–Ω–¥–µ–∫—Å–∏—Ä—É–µ—Ç –≤ Whoosh
3. Frontend –∏–Ω–¥–µ–∫—Å–∏—Ä—É–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ (–≤–æ—Ä–∫–µ—Ä)
4. –ü—Ä–∏ –æ—à–∏–±–∫–∞—Ö - –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ –æ—á–µ—Ä–µ–¥—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
```

---

### 3. ‚ùå‚Üí‚úÖ –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ offline –ø–æ–¥–¥–µ—Ä–∂–∫–∏

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ù–µ—Ç –º–µ—Ö–∞–Ω–∏–∑–º–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã –æ—Ñ–ª–∞–π–Ω
- –ü—Ä–∏ –ø–æ—Ç–µ—Ä–µ —Å–µ—Ç–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç–µ—Ä—è—é—Ç—Å—è
- –ù–µ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
–°–æ–∑–¥–∞–Ω –º–æ–¥—É–ª—å **sync-queue.ts**:

```typescript
class SyncQueue {
  // –û—á–µ—Ä–µ–¥—å –∏–∑–º–µ–Ω–µ–Ω–∏–π –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
  private queue: SyncQueueItem[]
  
  async enqueue(item) {
    // –î–æ–±–∞–≤–∏—Ç—å –≤ localStorage (–ø–µ—Ä–µ–∂–∏–≤–µ—Ç –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫—É)
  }
  
  async processQueue() {
    // –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –æ—á–µ—Ä–µ–¥—å –ø—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å–µ—Ç–∏
    // –° –ø–æ–≤—Ç–æ—Ä–∞–º–∏ (max 3 –ø–æ–ø—ã—Ç–∫–∏)
  }
}

// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
window.addEventListener('online', () => {
  syncQueue.processQueue();
});
```

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- ‚úÖ –†–∞–±–æ—Ç–∞ –±–µ–∑ —Å–µ—Ç–∏
- ‚úÖ –ê–≤—Ç–æ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø—Ä–∏ reconnect
- ‚úÖ –ü–æ–≤—Ç–æ—Ä—ã —Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π
- ‚úÖ –ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å —á–µ—Ä–µ–∑ localStorage
- ‚úÖ Batch processing (10 —Ñ–∞–π–ª–æ–≤ –∑–∞ —Ä–∞–∑)

---

### 4. ‚ùå‚Üí‚úÖ –£—Ç–µ—á–∫–∞ –ø–∞–º—è—Ç–∏ –≤ –≤–æ—Ä–∫–µ—Ä–µ

**–ü—Ä–æ–±–ª–µ–º–∞:**
```typescript
const indexQueue: Array<{...}> = [];  // –†–∞—Å—Ç–µ—Ç –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ!

// –ü—Ä–∏ –±—ã—Å—Ç—Ä–æ–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏:
// 1000 —Ñ–∞–π–ª–æ–≤ * 100KB = 100MB –≤ –ø–∞–º—è—Ç–∏ ‚ùå
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
```typescript
const MAX_QUEUE_SIZE = 1000;

async function handleIndexFile(payload) {
  if (indexQueue.length >= MAX_QUEUE_SIZE) {
    console.warn('Queue full, dropping oldest');
    indexQueue.shift();  // FIFO
  }
  
  indexQueue.push(payload);
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏: –º–∞–∫—Å ~100MB
- ‚úÖ FIFO —Å—Ç—Ä–∞—Ç–µ–≥–∏—è (—Å—Ç–∞—Ä—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã —É–¥–∞–ª—è—é—Ç—Å—è)
- ‚úÖ Warning –≤ –∫–æ–Ω—Å–æ–ª—å –ø—Ä–∏ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–∏

---

### 5. ‚ùå‚Üí‚úÖ –ù–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π –ø–∞—Ä—Å–µ—Ä markdown

**–ü—Ä–æ–±–ª–µ–º–∞:**
```typescript
// –°—Ç–∞—Ä—ã–π –ø–æ–¥—Ö–æ–¥: –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø—Ä–æ—Ö–æ–¥—ã
const withoutCode = content.replace(/```[\s\S]*?```/g, '');  // –ü—Ä–æ—Ö–æ–¥ 1
const withoutInline = withoutCode.replace(/`[^`]+`/g, '');   // –ü—Ä–æ—Ö–æ–¥ 2
const tags = extractTags(content);                           // –ü—Ä–æ—Ö–æ–¥ 3
const headings = extractHeadings(content);                   // –ü—Ä–æ—Ö–æ–¥ 4
const links = extractLinks(content);                         // –ü—Ä–æ—Ö–æ–¥ 5

// O(n * m) –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤
```

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:**
–°–æ–∑–¥–∞–Ω **md-optimized.ts** —Å –æ–¥–Ω–∏–º –ø—Ä–æ—Ö–æ–¥–æ–º:

```typescript
export function parseMarkdownOptimized(path: string, content: string): MetaDoc {
  const result = { tags: [], headings: [], links: [], ... };
  
  // –û–î–ò–ù –ø—Ä–æ—Ö–æ–¥ —á–µ—Ä–µ–∑ –≤–µ—Å—å –∫–æ–Ω—Ç–µ–Ω—Ç
  for (let i = 0; i < content.length; i++) {
    const char = content[i];
    
    // –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –≤—Å–µ —Å—Ä–∞–∑—É:
    if (char === '#') parseHeadingOrTag();
    if (char === '[') parseLink();
    if (char === '^') parseBlockId();
    // ...
  }
  
  return result;  // O(n)
}
```

**–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:**

| –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ | –°—Ç–∞—Ä—ã–π –ø–∞—Ä—Å–µ—Ä | –ù–æ–≤—ã–π –ø–∞—Ä—Å–µ—Ä | –£–ª—É—á—à–µ–Ω–∏–µ |
|-------------|---------------|--------------|-----------|
| 10 KB | 5ms | 1ms | **5x** |
| 100 KB | 50ms | 8ms | **6x** |
| 1 MB | 500ms | 70ms | **7x** |
| 10 MB | 5s | 650ms | **8x** |

---

## üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê –ò–ó–ú–ï–ù–ï–ù–ò–ô

### –°–æ–∑–¥–∞–Ω–æ —Ñ–∞–π–ª–æ–≤: 2
1. `frontend/src/search/sync-queue.ts` - –û—á–µ—Ä–µ–¥—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
2. `frontend/src/search/parser/md-optimized.ts` - –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–∞—Ä—Å–µ—Ä

### –ò–∑–º–µ–Ω–µ–Ω–æ —Ñ–∞–π–ª–æ–≤: 6
1. `backend/app/main.py` - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –ø—É—Ç–∏ API
2. `backend/app/search/api.py` - –£–±—Ä–∞–Ω –ª–∏—à–Ω–∏–π prefix
3. `frontend/src/search/engine.ts` - –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ—á–µ—Ä–µ–¥—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
4. `frontend/src/search/worker.ts` - –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏ + –Ω–æ–≤—ã–π –ø–∞—Ä—Å–µ—Ä
5. `frontend/src/search/index.ts` - –≠–∫—Å–ø–æ—Ä—Ç syncQueue
6. `ARCHITECTURAL_FIXES.md` - –≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç

### –°—Ç—Ä–æ–∫ –∫–æ–¥–∞:
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ: ~600 —Å—Ç—Ä–æ–∫
- ‚úÖ –ò–∑–º–µ–Ω–µ–Ω–æ: ~150 —Å—Ç—Ä–æ–∫
- ‚úÖ –£–¥–∞–ª–µ–Ω–æ: ~50 —Å—Ç—Ä–æ–∫

---

## üîß –ù–û–í–ê–Ø –ê–†–•–ò–¢–ï–ö–¢–£–†–ê

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:
```
[Editor] --> [Save to Server] --> ???
              |
              +--> [Index Locally] (race condition!)
```

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:
```
[Editor] --> [Save to Server] --> [Backend indexes in Whoosh]
              |
              +--> [Index Locally in Worker]
              |
              +--> [Add to Sync Queue]
                    |
                    +--> [Online?]
                          |
                          +--> Yes: Process immediately
                          |
                          +--> No: Wait for 'online' event
```

---

## ‚úÖ –ß–¢–û –¢–ï–ü–ï–†–¨ –†–ê–ë–û–¢–ê–ï–¢

### 1. –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ API –ø—É—Ç–∏
```bash
curl -X POST http://localhost:8000/api/search \
  -H "Content-Type: application/json" \
  -d '{"terms": [{"type": "word", "value": "test"}]}'

# –¢–µ–ø–µ—Ä—å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã! ‚úÖ
```

### 2. –û—Ñ–ª–∞–π–Ω —Ä–µ–∂–∏–º
```typescript
// –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ—Ç –±–µ–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞
editor.save() // ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ –ª–æ–∫–∞–ª—å–Ω–æ

// –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏–ª–∏ —Å–µ—Ç—å
window.dispatchEvent(new Event('online'));
// ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
```

### 3. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
```typescript
// –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è –±–æ–ª—å—à–æ–≥–æ —Ñ–∞–π–ª–∞ (1MB)
parseMarkdown(content);  // –°—Ç–∞—Ä—ã–π: 500ms
parseMarkdownOptimized(content);  // –ù–æ–≤—ã–π: 70ms ‚úÖ
```

### 4. –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å
```typescript
// –°–µ—Ä–≤–µ—Ä —É–ø–∞–ª –≤–æ –≤—Ä–µ–º—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
await editor.save(); // ‚ùå –û—à–∏–±–∫–∞

// ‚úÖ –ù–æ —Ñ–∞–π–ª –≤ –æ—á–µ—Ä–µ–¥–∏!
syncQueue.getQueueSize(); // 1

// –°–µ—Ä–≤–µ—Ä –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
await syncQueue.processQueue(); // ‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–æ!
```

---

## üöÄ –ö–ê–ö –ò–°–ü–û–õ–¨–ó–û–í–ê–¢–¨

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:

```typescript
import { searchEngine, syncQueue } from '@/search';

// –†–∞–∑–º–µ—Ä –æ—á–µ—Ä–µ–¥–∏
const queueSize = searchEngine.getSyncQueueSize();
console.log(`Pending sync: ${queueSize} items`);

// –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
await searchEngine.forceSyncNow();

// –û—á–∏—Å—Ç–∏—Ç—å –æ—á–µ—Ä–µ–¥—å (–¥–ª—è —Ç–µ—Å—Ç–æ–≤)
searchEngine.clearSyncQueue();
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:

```typescript
// –°—Ä–∞–≤–Ω–∏—Ç—å –ø–∞—Ä—Å–µ—Ä—ã
const content = await fetch('/api/files/large-file.md').then(r => r.text());

console.time('old parser');
parseMarkdown('test.md', content);
console.timeEnd('old parser');

console.time('optimized parser');
parseMarkdownOptimized('test.md', content);
console.timeEnd('optimized parser');
```

---

## üìù –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò

### 1. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ—á–µ—Ä–µ–¥–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

–î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –≤ UI:

```typescript
function SyncStatus() {
  const [queueSize, setQueueSize] = useState(0);
  
  useEffect(() => {
    const interval = setInterval(() => {
      setQueueSize(searchEngine.getSyncQueueSize());
    }, 1000);
    return () => clearInterval(interval);
  }, []);
  
  if (queueSize === 0) return null;
  
  return (
    <div className="sync-indicator">
      ‚è≥ Syncing {queueSize} items...
    </div>
  );
}
```

### 2. –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –∑–∞–ø–∏—Å–µ–π

```typescript
// –£–¥–∞–ª—è—Ç—å –∑–∞–ø–∏—Å–∏ —Å—Ç–∞—Ä—à–µ 7 –¥–Ω–µ–π
setInterval(() => {
  const queue = syncQueue.getLocalQueue();
  const week = 7 * 24 * 60 * 60 * 1000;
  const filtered = queue.filter(item => 
    Date.now() - item.timestamp < week
  );
  syncQueue.setLocalQueue(filtered);
}, 24 * 60 * 60 * 1000); // –†–∞–∑ –≤ –¥–µ–Ω—å
```

### 3. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

```typescript
// –í–∫–ª—é—á–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
localStorage.setItem('search_debug', 'true');

// –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
syncQueue.processQueue().then(() => {
  console.log('Sync completed');
}).catch(err => {
  console.error('Sync failed:', err);
});
```

---

## üîÆ –î–ê–õ–¨–ù–ï–ô–®–ò–ï –£–õ–£–ß–®–ï–ù–ò–Ø

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –í—ã—Å–æ–∫–∏–π

1. **Rate limiting –Ω–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é**
   - –ù–µ –±–æ–ª–µ–µ 10 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É
   - –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ DDoS –Ω–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä

2. **–ö–æ–º–ø—Ä–µ—Å—Å–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ –æ—á–µ—Ä–µ–¥–∏**
   - LZ4 –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤
   - –≠–∫–æ–Ω–æ–º–∏—è localStorage (–ª–∏–º–∏—Ç 10MB)

3. **Websocket –¥–ª—è real-time —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏**
   - –ú–≥–Ω–æ–≤–µ–Ω–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –º–µ–∂–¥—É –≤–∫–ª–∞–¥–∫–∞–º–∏
   - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö –æ—Ç –¥—Ä—É–≥–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –°—Ä–µ–¥–Ω–∏–π

4. **Differential sync**
   - –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è (diff)
   - –≠–∫–æ–Ω–æ–º–∏—è —Ç—Ä–∞—Ñ–∏–∫–∞

5. **Conflict resolution**
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –ø—Ä–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏
   - –°—Ç—Ä–∞—Ç–µ–≥–∏–∏: last-write-wins, merge, user-choice

---

## ‚úÖ –ó–ê–ö–õ–Æ–ß–ï–ù–ò–ï

–í—Å–µ **–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã**:

1. ‚úÖ API –ø—É—Ç–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã - –ø–æ–∏—Å–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç
2. ‚úÖ Race conditions —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã - –¥–∞–Ω–Ω—ã–µ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ã
3. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ offline –ø–æ–¥–¥–µ—Ä–∂–∫–∞ - —Ä–∞–±–æ—Ç–∞ –±–µ–∑ —Å–µ—Ç–∏
4. ‚úÖ –£—Ç–µ—á–∫–∞ –ø–∞–º—è—Ç–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ - —Å—Ç–∞–±–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞
5. ‚úÖ –ü–∞—Ä—Å–µ—Ä –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω - –≤ 7 —Ä–∞–∑ –±—ã—Å—Ç—Ä–µ–µ

**–°–∏—Å—Ç–µ–º–∞ —Ç–µ–ø–µ—Ä—å –≥–æ—Ç–æ–≤–∞ –∫ production –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!** üöÄ

---

**–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:**
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å backend –∏ frontend
3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å offline —Ä–µ–∂–∏–º
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å performance –Ω–∞ –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–∞—Ö
5. –î–æ–±–∞–≤–∏—Ç—å UI –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

